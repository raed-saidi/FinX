# config/qdrant_config.yaml
# Qdrant Configuration for Production Deployment

# Qdrant Connection
qdrant:
  # Connection type: 'docker' (local), 'cloud' (Qdrant Cloud), or 'remote' (self-hosted)
  deployment_type: "docker"
  
  # Docker deployment settings
  docker:
    host: "localhost"
    port: 6333
    grpc_port: 6334
    container_name: "qdrant-smart-investment"
    image: "qdrant/qdrant:latest"
    volume_path: "./data/qdrant_storage"
  
  # Cloud deployment settings (Qdrant Cloud)
  cloud:
    url: "https://your-cluster.aws.cloud.qdrant.io"
    api_key: "${QDRANT_API_KEY}"  # Set via environment variable
    timeout: 30
  
  # Remote deployment settings (self-hosted)
  remote:
    url: "http://your-qdrant-server:6333"
    api_key: null  # Optional
    timeout: 30

# Collection Configuration
collection:
  name: "market_windows_v1"
  distance_metric: "Cosine"  # Options: Cosine, Euclid, Dot
  vector_size: null  # Auto-calculated from features
  
  # Indexing parameters
  hnsw_config:
    m: 16  # Number of edges per node (higher = better accuracy, more memory)
    ef_construct: 100  # Size of the dynamic candidate list (higher = better index quality)
  
  # Optimization
  optimizers_config:
    default_segment_number: 2
  
  # Replication (for production)
  replication_factor: 1  # Increase for high availability

# Window Configuration
windows:
  window_size: 30  # Trading days per window
  stride: 1  # Stride for sliding window (1 = no overlap reduction)
  min_required_points: 25  # Minimum non-NaN points in window

# Indexing Strategy
indexing:
  batch_size: 100  # Vectors per batch upload
  incremental: true  # Only index new windows
  state_file: "./data/vectordb/indexing_state.json"
  
  # Metadata to store
  store_metadata:
    - ticker
    - date_start
    - date_end
    - window_idx
    - returns_cumulative
    - returns_mean
    - returns_std
    - sharpe_ratio
    - volatility
    - max_drawdown

# Query Configuration
query:
  default_top_k: 10
  min_score: 0.0  # Minimum similarity score
  score_threshold: null  # Optional filtering
  
  # Filters
  enable_filters: true
  default_filters:
    ticker: null  # Filter by specific ticker(s)
    date_range: null  # Filter by date range

# Performance
performance:
  parallel_workers: 4
  prefetch_size: 10
  max_retries: 3
  retry_delay: 1.0

# Monitoring
monitoring:
  enable_logging: true
  log_level: "INFO"
  track_indexing_time: true
  track_query_time: true

# Data Persistence
persistence:
  vectordb_dir: "./data/vectordb"
  backup_enabled: true
  backup_dir: "./data/vectordb/backups"
  backup_frequency: "daily"
