import{j as s}from"./@radix-D8tIKeo-.js";import{w as y,bk as C,bl as U,B as x,bu as q,bm as F,bn as I,D,I as h,bv as T,bq as E,br as k,x as g,aa as K,bs as A,aK as Q,u as V,k as _,e as S,A as O,f as B,s as M,h as R}from"./index-rPJfPIfq.js";import{u as v}from"./update-current-user-mutation-BL4r-9iR.js";import{u as b,t as P,z as r}from"./@zod-2qqdh1cM.js";import{h as z}from"./@tanstack-nMqraTcu.js";import{a as o}from"./@monaco-editor-CuNQBT0l.js";import{P as H}from"./PasswordChecker-CgLXakl-.js";import{u as L}from"./UpdatePasswordSchemas-B_4QwKjY.js";import"./@elkjs-CmhuJAjY.js";import"./@react-router-D1ODL_Ub.js";import"./@reactflow-DgowYF6H.js";const G=r.object({avatarUrl:r.string().transform(e=>e?.trim()??null)});function J(){const[e,t]=o.useState(!1),n=z(),{toast:d}=y(),c=v({onSuccess:()=>{n.invalidateQueries({queryKey:["current-user"]}),n.invalidateQueries({queryKey:["users"]}),t(!1)},onError:a=>{a instanceof Error&&d({status:"error",emphasis:"subtle",icon:s.jsx(g,{className:"h-5 w-5 shrink-0 fill-error-700"}),description:a.message,rounded:!0})}}),i=b({resolver:P(G),defaultValues:{avatarUrl:""}});function p(a){c.mutate({avatar_url:a.avatarUrl})}function m(a){t(a),i.reset()}return s.jsxs(C,{open:e,onOpenChange:m,children:[s.jsx(U,{asChild:!0,children:s.jsxs(x,{intent:"secondary",size:"md",className:"absolute right-1 top-1 flex h-6 w-6 items-center justify-center bg-theme-surface-primary",children:[s.jsx("span",{className:"sr-only",children:"Edit Avatar"}),s.jsx(q,{className:"h-5 w-5 shrink-0 fill-theme-text-primary"})]})}),s.jsxs(F,{children:[s.jsx(I,{children:s.jsx(D,{children:"Update Avatar"})}),s.jsxs("div",{className:"p-7",children:[s.jsx("form",{id:"image-form",onSubmit:i.handleSubmit(p),children:s.jsxs("label",{className:"space-y-0.5",children:[s.jsx("div",{className:"text-text-sm",children:"Avatar URL"}),s.jsx(h,{placeholder:"https://zenml.io/logo.png",className:"w-full",...i.register("avatarUrl")})]})}),s.jsx(T,{className:"mt-1 border-none text-text-xs text-theme-text-secondary",children:"This will be profile avatar"})]}),s.jsx(E,{children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(k,{asChild:!0,children:s.jsx(x,{intent:"secondary",children:"Cancel"})}),s.jsx(x,{type:"submit",form:"image-form",intent:"primary",disabled:c.isPending||!i.formState.isValid,children:"Update"})]})})]})]})}function W(){const[e,t]=o.useState(!1);return s.jsxs(C,{onOpenChange:()=>{t(!1)},children:[s.jsx(U,{asChild:!0,children:s.jsx(x,{size:"md",className:"shrink-0",intent:"primary",emphasis:"subtle",children:"Change Password"})}),s.jsxs(F,{children:[s.jsx(I,{children:s.jsx(D,{children:" Update Credentials"})}),e?s.jsx(Y,{}):s.jsx(X,{setSuccess:t})]})]})}function X({setSuccess:e}){const t=o.useId(),n=o.useId(),d=o.useId(),{toast:c}=y(),{mutate:i,isPending:p}=v({onSuccess(){e(!0)},onError(u){A(u)&&c({status:"error",emphasis:"subtle",icon:s.jsx(g,{className:"h-5 w-5 shrink-0 fill-error-700"}),description:u.message,rounded:!0})}}),{register:m,handleSubmit:a,watch:f,formState:{isValid:j,errors:w}}=b({resolver:P(L),mode:"onChange",criteriaMode:"all"});function N(u){i({old_password:u.oldPassword,password:u.newPassword})}const l=w.newPassword?.types;return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"space-y-5 p-7",children:[s.jsx("form",{id:"update-password-form",onSubmit:a(N),children:s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"space-y-0.5",children:[s.jsx("label",{htmlFor:t,className:"text-text-sm",children:"Old Password"}),s.jsx(h,{...m("oldPassword"),type:"password",id:t,className:"w-full"})]}),s.jsxs("div",{className:"space-y-0.5",children:[s.jsx("label",{htmlFor:n,className:"text-text-sm",children:"New Password"}),s.jsx(h,{...m("newPassword"),type:"password",id:n,className:"w-full"})]}),s.jsxs("div",{className:"space-y-0.5",children:[s.jsx("label",{htmlFor:d,className:"text-text-sm",children:"Confirm Password"}),s.jsx(h,{...m("confirmPassword"),type:"password",id:d,className:"w-full"})]})]})}),s.jsx(H,{val:f("newPassword"),errors:l||[]})]}),s.jsxs(E,{className:"gap-[10px]",children:[s.jsx(k,{asChild:!0,children:s.jsx(x,{size:"sm",intent:"secondary",children:"Cancel"})}),s.jsx(x,{disabled:!j||p,form:"update-password-form",size:"sm",children:"Update Password"})]})]})}function Y(){return s.jsxs("div",{className:"space-y-5 p-7 text-center",children:[s.jsx(K,{className:"mx-auto h-[110px] w-[110px] fill-success-500"}),s.jsx("p",{className:"text-text-lg font-semibold text-theme-text-primary",children:"The password was updated successfully!"})]})}const Z=r.object({fullName:r.union([r.string(),r.literal("")]),username:r.union([r.string(),r.literal("")]),email:r.union([r.string().email(),r.literal("")])}).refine(e=>e.fullName!==""||e.username!==""||e.email!=="");function $({user:e}){const t=z(),{toast:n}=y(),d=o.useId(),c=o.useId(),i=o.useId(),{isPending:p,mutate:m}=v({onError(l){A(l)&&n({status:"error",emphasis:"subtle",icon:s.jsx(g,{className:"h-5 w-5 shrink-0 fill-error-700"}),description:l.message,rounded:!0})},onSuccess:()=>{t.invalidateQueries({queryKey:["current-user"]}),t.invalidateQueries({queryKey:["users"]}),f(),n({status:"success",emphasis:"subtle",rounded:!0,description:"User updated successfully"})}}),{register:a,reset:f,handleSubmit:j,formState:{isValid:w}}=b({resolver:P(Z),defaultValues:{email:void 0,fullName:void 0,username:void 0}});function N(l){const u={...l.fullName&&{full_name:l.fullName},...l.username&&{name:l.username},...l.email&&{email:l.email}};m(u)}return s.jsxs("div",{className:"w-full max-w-[600px]",children:[s.jsx("form",{onSubmit:j(N),children:s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"space-y-0.5",children:[s.jsx("label",{htmlFor:d,className:"text-text-sm",children:"Full Name"}),s.jsx(h,{placeholder:e.body?.full_name,...a("fullName"),id:d,className:"w-full"})]}),s.jsxs("div",{className:"space-y-0.5",children:[s.jsx("label",{htmlFor:c,className:"text-text-sm",children:"Username"}),s.jsx(h,{...a("username"),placeholder:e.name,id:c,className:"w-full"})]}),s.jsxs("div",{className:"space-y-0.5",children:[s.jsx("label",{htmlFor:i,className:"text-text-sm",children:"Email"}),s.jsx(h,{placeholder:e.metadata?.email??void 0,...a("email"),id:i,className:"w-full"})]}),s.jsx("div",{className:"flex justify-end",children:s.jsx(x,{disabled:p||!w,size:"md",intent:"primary",children:"Update"})})]})}),s.jsx(W,{}),s.jsxs("p",{className:"mt-5 text-text-sm text-theme-text-secondary",children:["Created on ",s.jsx(Q,{dateString:e.body?.created||""})]})]})}function ms(){const{data:e}=V();return s.jsxs(_,{className:"flex flex-col gap-5 p-5",children:[s.jsx("h1",{className:"text-text-xl font-semibold",children:"Profile"}),s.jsxs("div",{className:"flex justify-between",children:[e?s.jsx($,{user:e}):s.jsx(S,{className:"h-[350px] w-full"}),e?s.jsxs(O,{size:"xxl",className:"ml-5 h-[140px] w-[140px]",type:"square",children:[s.jsx(B,{src:M(e.body?.avatar_url??void 0)}),s.jsx(R,{className:"text-display-lg",size:"xxl",children:e.name[0]}),s.jsx(J,{})]}):s.jsx(S,{className:"h-[140px] w-[140px] rounded-rounded"})]})]})}export{ms as default};
